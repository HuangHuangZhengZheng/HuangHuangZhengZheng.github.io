<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>DATA100-lab2 - HHZZ`s space</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="DATA100-lab2" />
<meta property="og:description" content="1 2 3 # Initialize Otter import otter grader = otter.Notebook(&#34;lab02.ipynb&#34;) Pandas is one of the most widely used Python libraries in data science. In this lab, you will review commonly used data wrangling operations/tools in Pandas. We aim to give you familiarity with:
Creating DataFrames Slicing DataFrames (i.e. selecting rows and columns) Filtering data (using boolean arrays and groupby.filter) Aggregating (using groupby.agg) In this lab you are going to use several pandas methods." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/datalab2/" /><meta property="og:image" content="http://example.org/logo.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-07-15T18:20:24+08:00" />
<meta property="article:modified_time" content="2024-07-15T18:20:24+08:00" /><meta property="og:site_name" content="My cool site" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://example.org/logo.png" /><meta name="twitter:title" content="DATA100-lab2"/>
<meta name="twitter:description" content="1 2 3 # Initialize Otter import otter grader = otter.Notebook(&#34;lab02.ipynb&#34;) Pandas is one of the most widely used Python libraries in data science. In this lab, you will review commonly used data wrangling operations/tools in Pandas. We aim to give you familiarity with:
Creating DataFrames Slicing DataFrames (i.e. selecting rows and columns) Filtering data (using boolean arrays and groupby.filter) Aggregating (using groupby.agg) In this lab you are going to use several pandas methods."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/datalab2/" /><link rel="prev" href="http://example.org/datal7/" /><link rel="next" href="http://example.org/datal8/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "DATA100-lab2",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/datalab2\/"
        },"genre": "posts","keywords": "Pandas","wordcount":  6782 ,
        "url": "http:\/\/example.org\/datalab2\/","datePublished": "2024-07-15T18:20:24+08:00","dateModified": "2024-07-15T18:20:24+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "HHZZ"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="HHZZ`s space">Code and BeyondCode😋</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tools/"> Tools </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/beyondcode/"> BeyondCode😋 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="HHZZ`s space">Code and BeyondCode😋</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tools/" title="">Tools</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/beyondcode/" title="">BeyondCode😋</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">DATA100-lab2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>HHZZ</a></span>&nbsp;<span class="post-category">included in <a href="/categories/data100/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>DATA100</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-07-15">2024-07-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;6782 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;32 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#creating-dataframes--basic-manipulations">Creating DataFrames &amp; Basic Manipulations</a>
      <ul>
        <li><a href="#review-selecting-rows-and-columns-in-pandas">REVIEW: Selecting Rows and Columns in Pandas</a>
          <ul>
            <li><a href="#approach-1-loc">Approach 1: <code>loc</code></a></li>
            <li><a href="#approach-2-iloc">Approach 2: <code>iloc</code></a></li>
            <li><a href="#approach-3--notation-for-accessing-rows-and-columns">Approach 3: <code>[]</code> Notation for Accessing Rows and Columns</a></li>
          </ul>
        </li>
        <li><a href="#question-1a">Question 1(a)</a></li>
        <li><a href="#question-1b">Question 1(b)</a></li>
        <li><a href="#question-2">Question 2</a></li>
        <li><a href="#question-3">Question 3</a></li>
        <li><a href="#babynames-dataset">Babynames Dataset</a></li>
        <li><a href="#fetch_and_cache-helper"><code>fetch_and_cache</code> Helper</a></li>
        <li><a href="#selection-examples-on-baby-names">Selection Examples on Baby Names</a></li>
        <li><a href="#question-4">Question 4</a></li>
      </ul>
    </li>
    <li><a href="#filtering-data">Filtering Data</a>
      <ul>
        <li><a href="#review-filtering-with-boolean-arrays">Review: Filtering with boolean arrays</a></li>
        <li><a href="#question-5">Question 5</a>
          <ul>
            <li><a href="#query-review">Query Review</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#groupby">Groupby</a>
      <ul>
        <li><a href="#question-6-elections">Question 6: Elections</a></li>
        <li><a href="#question-6a">Question 6a</a></li>
        <li><a href="#question-6b">Question 6b</a></li>
        <li><a href="#question-6c">Question 6c</a></li>
        <li><a href="#question-7">Question 7</a></li>
        <li><a href="#question-8">Question 8</a></li>
      </ul>
    </li>
    <li><a href="#bonus-exercises">Bonus Exercises</a>
      <ul>
        <li>
          <ul>
            <li><a href="#sorted-female-name-counts">Sorted Female Name Counts</a></li>
            <li><a href="#counts-for-all-names">Counts for All Names</a></li>
          </ul>
        </li>
        <li><a href="#extra-explore-the-data-set">Extra: Explore the Data Set</a></li>
      </ul>
    </li>
    <li><a href="#submission">Submission</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Initialize Otter</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">otter</span>
</span></span><span class="line"><span class="cl"><span class="n">grader</span> <span class="o">=</span> <span class="n">otter</span><span class="o">.</span><span class="n">Notebook</span><span class="p">(</span><span class="s2">&#34;lab02.ipynb&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p><a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreffer ">Pandas</a> is one of the most widely used Python libraries in data science. In this lab, you will review commonly used data wrangling operations/tools in Pandas. We aim to give you familiarity with:</p>
<ul>
<li>Creating DataFrames</li>
<li>Slicing DataFrames (i.e. selecting rows and columns)</li>
<li>Filtering data (using boolean arrays and groupby.filter)</li>
<li>Aggregating (using groupby.agg)</li>
</ul>
<p>In this lab you are going to use several pandas methods. Reminder from lecture that you may press <code>shift+tab</code> on method parameters to see the documentation for that method. For example, if you were using the <code>drop</code> method in pandas, you couold press shift+tab to see what <code>drop</code> is expecting.</p>
<p>Pandas is very similar to the datascience library that you saw in Data 8. This <a href="https://github.com/data-8/materials-x19/blob/master/reference/Datascience%20to%20Pandas%20Conversion%20Notebook.ipynb" target="_blank" rel="noopener noreffer ">conversion notebook</a> may serve as a useful guide!</p>
<p>This lab expects that you have watched the pandas lectures. If you have not, this lab will probably take a very long time.</p>
<p><strong>Note</strong>: The Pandas interface is notoriously confusing for beginners, and the documentation is not consistently great. Throughout the semester, you will have to search through Pandas documentation and experiment, but remember it is part of the learning experience and will help shape you as a data scientist!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="creating-dataframes--basic-manipulations">Creating DataFrames &amp; Basic Manipulations</h2>
<p>Recall that a <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html#dataframe" target="_blank" rel="noopener noreffer ">DataFrame</a> is a table in which each column has a specific data type; there is an index over the columns (typically string labels) and an index over the rows (typically ordinal numbers).</p>
<p>Usually you&rsquo;ll create DataFrames by using a function like <code>pd.read_csv</code>. However, in this section, we&rsquo;ll discuss how to create them from scratch.</p>
<p>The <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" target="_blank" rel="noopener noreffer ">documentation</a> for the pandas <code>DataFrame</code> class provides several constructors for the DataFrame class.</p>
<p><strong>Syntax 1:</strong> You can create a DataFrame by specifying the columns and values using a <em><strong>dictionary</strong></em> as shown below.</p>
<p>The keys of the dictionary are the column names, and the values of the dictionary are lists containing the row entries.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;raspberry&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;pink&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="s1">&#39;price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<p><strong>Syntax 2:</strong> You can also define a DataFrame by specifying the rows as shown below.</p>
<p>Each row corresponds to a distinct <em><strong>tuple</strong></em>, and the columns are specified separately.</p>
<p>这里可以看出<code>columns</code>是个参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">[(</span><span class="s2">&#34;red&#34;</span><span class="p">,</span> <span class="s2">&#34;apple&#34;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="s2">&#34;orange&#34;</span><span class="p">,</span> <span class="s2">&#34;orange&#34;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="p">(</span><span class="s2">&#34;yellow&#34;</span><span class="p">,</span> <span class="s2">&#34;banana&#34;</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">     <span class="p">(</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span> <span class="s2">&#34;raspberry&#34;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;color&#34;</span><span class="p">,</span> <span class="s2">&#34;fruit&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>red</td>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>yellow</td>
      <td>banana</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pink</td>
      <td>raspberry</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<p>You can obtain the dimensions of a DataFrame by using the shape attribute <code>DataFrame.shape</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">shape</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>(4, 3)
</code></pre>
<p>You can also <strong>convert the entire DataFrame into a two-dimensional NumPy array.</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">values</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>array([['apple', 'red', 1.0],
       ['orange', 'orange', 0.75],
       ['banana', 'yellow', 0.35],
       ['raspberry', 'pink', 0.05]], dtype=object)
</code></pre>
<p>There are other constructors but we do not discuss them here.</p>
<h3 id="review-selecting-rows-and-columns-in-pandas">REVIEW: Selecting Rows and Columns in Pandas</h3>
<p>As you&rsquo;ve seen in lecture and discussion, there are two verbose operators in Python for selecting rows: <code>loc</code> and <code>iloc</code>. Let&rsquo;s review them briefly.</p>
<h4 id="approach-1-loc">Approach 1: <code>loc</code></h4>
<p>The first of the two verbose operators is <code>loc</code>, which takes two arguments. The first is <em>one or more</em> <strong>row labels</strong>, the second is <em>one or more</em> <strong>column labels</strong>.</p>
<p>The desired rows or columns can be provided individually, in slice notation, or as a list. Some examples are given below.</p>
<p>Note that <strong>slicing in <code>loc</code> is inclusive</strong> on the provided labels.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#get rows 0 through 2 and columns fruit through price</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;fruit&#39;</span><span class="p">:</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="c1"># 闭区间</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 through 2 and columns fruit and price. </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Note the difference in notation and result from the previous example.</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span> <span class="c1"># 离散</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 and 2 and columns fruit and price. </span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span> <span class="c1"># 更加离散</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 and 2 and column fruit</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;fruit&#39;</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
    </tr>
  </tbody>
</table>
</div>
<p>Note that if we request a single column but don&rsquo;t enclose it in a list, the return type of the <code>loc</code> operator is a <code>Series</code> rather than a DataFrame.</p>
<p>注意[ ]包裹问题</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 and 2 and column fruit, returning the result as a Series</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;fruit&#39;</span><span class="p">]</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>0     apple
2    banana
Name: fruit, dtype: object
</code></pre>
<p>If we provide only one argument to <code>loc</code>, it uses the provided argument to select rows, and returns all columns.可以只给行， 不可以只给列</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
  </tbody>
</table>
</div>
<p>Note that if you try to access columns without providing rows, <code>loc</code> will crash.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># uncomment, this code will crash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fruit_info.loc[[&#34;fruit&#34;, &#34;price&#34;]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># uncomment, this code works fine: </span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&#34;fruit&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="approach-2-iloc">Approach 2: <code>iloc</code></h4>
<p><code>iloc</code> is very similar to <code>loc</code> except that its arguments are row numbers and column numbers, rather than row labels and labels names. A usueful mnemonic is that the <code>i</code> stands for &ldquo;integer&rdquo;.</p>
<p>In addition, <strong>slicing for <code>iloc</code> is exclusive</strong> on the provided integer indices. Some examples are given below:</p>
<p>考虑此时变成python经典索引</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 through 3 (exclusive) and columns 0 through 2 (exclusive)</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 through 3 (exclusive) and columns 0 and 2.</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 and 2 and columns 0 and 2.</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#get rows 0 and 2 and column fruit</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># get rows 0 and 2 and column fruit</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># return a Series!</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>0     apple
2    banana
Name: fruit, dtype: object
</code></pre>
<p>Note that in these loc and iloc examples above, the row <strong>label</strong> and row <strong>number</strong> were always the same.</p>
<p>Let&rsquo;s see an example where they are different. If we sort our fruits by <em>price</em>, we get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info_sorted</span> <span class="o">=</span> <span class="n">fruit_info</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&#34;price&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info_sorted</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
<p>Observe that the row number 0 now has index 3, row number 1 now has index 2, etc. These indices are the arbitrary numerical index generated when we created the DataFrame. For example, banana was originally in row 2, and so it has row label 2.</p>
<p>If we request the rows in positions 0 and 2 using <code>iloc</code>,  <strong>we&rsquo;re indexing using the row NUMBERS, not labels.</strong></p>
<p>这里似乎并不是按照lab所说的那样?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info_sorted</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># 别和数学表达混淆!</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>3    raspberry
1       orange
Name: fruit, dtype: object
</code></pre>
<p>Lastly, similar to with <code>loc</code>, the second argument to <code>iloc</code> is optional. That is, if you provide only one argument to <code>iloc</code>, it treats the argument you provide as a set of desired row numbers, not column numbers. 可以只给行，不可给列</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
  </tbody>
</table>
</div>
<h4 id="approach-3--notation-for-accessing-rows-and-columns">Approach 3: <code>[]</code> Notation for Accessing Rows and Columns</h4>
<p>Pandas also supports a bare <code>[]</code> operator. It&rsquo;s similar to <code>loc</code> in that it lets you access rows and columns by their name.</p>
<p>However, unlike <code>loc</code>, which takes row names and also optionally column names, <code>[]</code> is more flexible. If you provde it only row names, it&rsquo;ll give you rows (same behavior as <code>loc</code>), and if you provide it with only column names, it&rsquo;ll give you columns (whereas <code>loc</code> will crash).</p>
<p>Some examples:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Here we&#39;re providing a list of fruits as single argument to []</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="p">[[</span><span class="s2">&#34;fruit&#34;</span><span class="p">,</span> <span class="s2">&#34;color&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<p>Note that <strong>slicing notation is not supported for columns if you use <code>[]</code> notation.</strong> Use <code>loc</code> instead.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># uncomment and this code crashes</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fruit_info[&#34;fruit&#34;:&#34;price&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># uncomment and this works fine</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&#34;fruit&#34;</span><span class="p">:</span><span class="s2">&#34;price&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<p><code>[]</code> and <code>loc</code> are quite similar. For example, the following two pieces of code are functionally equivalent for selecting the fruit and price columns.</p>
<ol>
<li><code>fruit_info[[&quot;fruit&quot;, &quot;price&quot;]]</code></li>
<li><code>fruit_info.loc[:, [&quot;fruit&quot;, &quot;price&quot;]]</code>.</li>
</ol>
<p>Because it yields more concise code, you&rsquo;ll find that our code and your code both tend to feature <code>[]</code>. However, there are some subtle pitfalls of using <code>[]</code>. If you&rsquo;re ever having performance issues, weird behavior, or you see a <code>SettingWithCopyWarning</code> in pandas, switch from <code>[]</code> to <code>loc</code> and this may help.</p>
<p>To avoid getting too bogged down in indexing syntax, we&rsquo;ll avoid a more thorough discussion of <code>[]</code> and <code>loc</code>. We may return to this at a later point in the course.</p>
<p>For more on <code>[]</code> vs <code>loc</code>, you may optionally try reading:</p>
<ol>
<li><a href="https://stackoverflow.com/questions/48409128/what-is-the-difference-between-using-loc-and-using-just-square-brackets-to-filte" target="_blank" rel="noopener noreffer ">https://stackoverflow.com/questions/48409128/what-is-the-difference-between-using-loc-and-using-just-square-brackets-to-filte</a></li>
<li><a href="https://stackoverflow.com/questions/38886080/python-pandas-series-why-use-loc/65875826#65875826" target="_blank" rel="noopener noreffer ">https://stackoverflow.com/questions/38886080/python-pandas-series-why-use-loc/65875826#65875826</a></li>
<li><a href="https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas/53954986#53954986" target="_blank" rel="noopener noreffer ">https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas/53954986#53954986</a></li>
</ol>
<p>Now that we&rsquo;ve reviewed basic indexing, let&rsquo;s discuss how we can modify dataframes. We&rsquo;ll do this via a series of exercises.</p>
<h3 id="question-1a">Question 1(a)</h3>
<p>For a DataFrame <code>d</code>, you can add a column with <code>d['new column name'] = ...</code> and assign a list or array of values to the column. Add a column of integers containing 1, 2, 3, and 4 called <code>rank1</code> to the <code>fruit_info</code> table which expresses your personal preference about the taste ordering for each fruit (1 is tastiest; 4 is least tasty).</p>
<!--
BEGIN QUESTION
name: q1a
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="p">[</span><span class="s1">&#39;rank1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
      <th>rank1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q1a&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><pre style='display: inline;'>q1a</pre></strong> passed! 💯</p>
<h3 id="question-1b">Question 1(b)</h3>
<p>You can also add a column to <code>d</code> with <code>d.loc[:, 'new column name'] = ...</code>. As above, the first parameter is for the rows and second is for columns. The <code>:</code> means change all rows and the <code>'new column name'</code> indicates the name of the column you are modifying (or in this case, adding).</p>
<p>Add a column called <code>rank2</code> to the <code>fruit_info</code> table which contains the same values in the same order as the <code>rank1</code> column.</p>
<!--
BEGIN QUESTION
name: q1b
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;rank2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
      <th>rank1</th>
      <th>rank2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q1b&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><pre style='display: inline;'>q1b</pre></strong> passed! 🍀</p>
<h3 id="question-2">Question 2</h3>
<p>Use the <code>.drop()</code> method to <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop.html" target="_blank" rel="noopener noreffer ">drop</a> both the <code>rank1</code> and <code>rank2</code> columns you created. Make sure to use the <code>axis</code> parameter correctly. Note that <code>drop</code> does not change a table, but instead returns a new table with fewer columns or rows unless you set the optional <code>inplace</code> parameter.</p>
<p><em>Hint</em>: Look through the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html" target="_blank" rel="noopener noreffer ">documentation</a> to see how you can drop multiple columns of a Pandas DataFrame at once using a list of column names.</p>
<!--
BEGIN QUESTION
name: q2
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info_original</span> <span class="o">=</span> <span class="n">fruit_info</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rank1&#39;</span><span class="p">,</span><span class="s1">&#39;rank2&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info_original</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruit</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q2&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><pre style='display: inline;'>q2</pre></strong> passed! 💯</p>
<h3 id="question-3">Question 3</h3>
<p>Use the <code>.rename()</code> method to <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html" target="_blank" rel="noopener noreffer ">rename</a> the columns of <code>fruit_info_original</code> so they begin with capital letters. Set this new DataFrame to <code>fruit_info_caps</code>. For an example of how to use rename, see the linked documentation above.</p>
<!--
BEGIN QUESTION
name: q3
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fruit_info_caps</span> <span class="o">=</span> <span class="n">fruit_info_original</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fruit&#39;</span><span class="p">:</span><span class="s1">&#39;Fruit&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;Color&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">:</span><span class="s1">&#39;Price&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">fruit_info_caps</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fruit</th>
      <th>Color</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>apple</td>
      <td>red</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>orange</td>
      <td>orange</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>2</th>
      <td>banana</td>
      <td>yellow</td>
      <td>0.35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raspberry</td>
      <td>pink</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q3&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><pre style='display: inline;'>q3</pre></strong> passed! 🎉</p>
<h3 id="babynames-dataset">Babynames Dataset</h3>
<p>For the new few questions of this lab, let&rsquo;s move on to a real world dataset. We&rsquo;ll be using the babynames dataset from Lecture 1. The babynames dataset contains a record of the given names of babies born in the United States each year.</p>
<p>First let&rsquo;s run the following cells to build the DataFrame <code>baby_names</code>.
The cells below download the data from the web and extract the data into a DataFrame. There should be a total of 6215834 records.</p>
<h3 id="fetch_and_cache-helper"><code>fetch_and_cache</code> Helper</h3>
<p>The following function downloads and caches data in the <code>data/</code> directory and returns the <code>Path</code> to the downloaded file. The cell below the function describes how it works. You are not expected to understand this code, but you may find it useful as a reference as a practitioner of data science after the course.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fetch_and_cache</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="s2">&#34;data&#34;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Download and cache a url and return the file object.
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    data_url: the web address to download
</span></span></span><span class="line"><span class="cl"><span class="s2">    file: the file in which to save the results.
</span></span></span><span class="line"><span class="cl"><span class="s2">    data_dir: (default=&#34;data&#34;) the location to save the data
</span></span></span><span class="line"><span class="cl"><span class="s2">    force: if true the file is always re-downloaded 
</span></span></span><span class="line"><span class="cl"><span class="s2">    
</span></span></span><span class="line"><span class="cl"><span class="s2">    return: The pathlib.Path to the file.
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">file_path</span> <span class="o">=</span> <span class="n">data_dir</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">force</span> <span class="ow">and</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">force</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloading...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">file_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="kn">import</span> <span class="nn">time</span> 
</span></span><span class="line"><span class="cl">        <span class="n">created</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">file_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_ctime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Using cached version downloaded at&#34;</span><span class="p">,</span> <span class="n">created</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">file_path</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In Python, a <code>Path</code> object represents the filesystem paths to files (and other resources). The <code>pathlib</code> module is effective for writing code that works on different operating systems and filesystems.</p>
<p>To check if a file exists at a path, use <code>.exists()</code>. To create a directory for a path, use <code>.mkdir()</code>. To remove a file that might be a <a href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank" rel="noopener noreffer ">symbolic link</a>, use <code>.unlink()</code>.</p>
<p>This function creates a path to a directory that will contain data files. It ensures that the directory exists (which is required to write files in that directory), then proceeds to download the file based on its URL.</p>
<p>The benefit of this function is that not only can you force when you want a new file to be downloaded using the <code>force</code> parameter, but in cases when you don&rsquo;t need the file to be re-downloaded, you can use the cached version and save download time.</p>
<p>Below we use <code>fetch_and_cache</code> to download the <code>namesbystate.zip</code> zip file, which is a compressed directory of CSV files.</p>
<p><strong>This might take a little while! Consider stretching.</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.ssa.gov/oact/babynames/state/namesbystate.zip&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">namesbystate_path</span> <span class="o">=</span> <span class="n">fetch_and_cache</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="s1">&#39;namesbystate.zip&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Using cached version downloaded at Fri Jul 12 20:04:41 2024
</code></pre>
<p>The following cell builds the final full <code>baby_names</code> DataFrame. It first builds one DataFrame per state, because that&rsquo;s how the data are stored in the zip file. Here is documentation for <a href="https://pandas.pydata.org/pandas-docs/version/1.2/reference/api/pandas.concat.html" target="_blank" rel="noopener noreffer ">pd.concat</a> if you want to know more about its functionality. As before, you are not expected to understand this code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zipfile</span>
</span></span><span class="line"><span class="cl"><span class="n">zf</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">namesbystate_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">column_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">load_dataframe_from_zip</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">zf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">states</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="n">load_dataframe_from_zip</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">zf</span><span class="o">.</span><span class="n">filelist</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.TXT&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">baby_names</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">state_df</span> <span class="ow">in</span> <span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">baby_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">baby_names</span><span class="p">,</span> <span class="n">state_df</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">baby_names</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nb">len</span><span class="p">(</span><span class="n">baby_names</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>6215834
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">baby_names</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AK</td>
      <td>F</td>
      <td>1910</td>
      <td>Mary</td>
      <td>14</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AK</td>
      <td>F</td>
      <td>1910</td>
      <td>Annie</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AK</td>
      <td>F</td>
      <td>1910</td>
      <td>Anna</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AK</td>
      <td>F</td>
      <td>1910</td>
      <td>Margaret</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AK</td>
      <td>F</td>
      <td>1910</td>
      <td>Helen</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="selection-examples-on-baby-names">Selection Examples on Baby Names</h3>
<p>As with our synthetic fruit dataset, we can use <code>loc</code> and <code>iloc</code> to select rows and columns of interest from our dataset.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">baby_names</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="c1"># Series</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>2        Anna
3    Margaret
4       Helen
5       Elsie
Name: Name, dtype: object
</code></pre>
<p>Notice the difference between the following cell and the previous one, just passing in <code>'Name'</code> returns a Series while <code>['Name']</code> returns a DataFrame.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">baby_names</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]]</span> <span class="c1">#df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Anna</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Margaret</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Helen</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Elsie</td>
    </tr>
  </tbody>
</table>
</div>
<p>The code below collects the rows in positions 1 through 3, and the column in position 3 (&ldquo;Name&rdquo;).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">baby_names</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Annie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Anna</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Margaret</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="question-4">Question 4</h3>
<p>Use <code>.loc</code> to select <code>Name</code> and <code>Year</code> <strong>in that order</strong> from the <code>baby_names</code> table.</p>
<!--
BEGIN QUESTION
name: q4
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">name_and_year</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">name_and_year</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 版本问题</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annie</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Anna</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Margaret</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Helen</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q4&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now repeat the same selection using the plain <code>[]</code> notation.</p>
<p>接受一个list of columns</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">name_and_year</span> <span class="o">=</span> <span class="n">baby_names</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;Year&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">name_and_year</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Annie</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Anna</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Margaret</td>
      <td>1910</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Helen</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="filtering-data">Filtering Data</h2>
<h3 id="review-filtering-with-boolean-arrays">Review: Filtering with boolean arrays</h3>
<p>Filtering is the process of removing unwanted material.  In your quest for cleaner data, you will undoubtedly filter your data at some point: whether it be for clearing up cases with missing values, for culling out fishy outliers, or for analyzing subgroups of your data set.  Example usage looks like <code>df[df['column name'] &lt; 5]</code>.</p>
<p>For your reference, some commonly used comparison operators are given below.</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Usage</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>==</td>
<td>a == b</td>
<td>Does a equal b?</td>
</tr>
<tr>
<td>&lt;=</td>
<td>a &lt;= b</td>
<td>Is a less than or equal to b?</td>
</tr>
<tr>
<td>&gt;=</td>
<td>a &gt;= b</td>
<td>Is a greater than or equal to b?</td>
</tr>
<tr>
<td>&lt;</td>
<td>a &lt; b</td>
<td>Is a less than b?</td>
</tr>
<tr>
<td>&gt;</td>
<td>a &gt; b</td>
<td>Is a greater than b?</td>
</tr>
<tr>
<td>~</td>
<td>~p</td>
<td>Returns negation of p</td>
</tr>
<tr>
<td>|</td>
<td>p | q</td>
<td>p OR q</td>
</tr>
<tr>
<td>&amp;</td>
<td>p &amp; q</td>
<td>p AND q</td>
</tr>
<tr>
<td>^</td>
<td>p ^ q</td>
<td>p XOR q (exclusive or)</td>
</tr>
</tbody>
</table>
<p>In the following we construct the DataFrame containing only names registered in California注意这里十分重要!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ca</span> <span class="o">=</span> <span class="n">baby_names</span><span class="p">[</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ca</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>390635</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Mary</td>
      <td>295</td>
    </tr>
    <tr>
      <th>390636</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Helen</td>
      <td>239</td>
    </tr>
    <tr>
      <th>390637</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Dorothy</td>
      <td>220</td>
    </tr>
    <tr>
      <th>390638</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Margaret</td>
      <td>163</td>
    </tr>
    <tr>
      <th>390639</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Frances</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="question-5">Question 5</h3>
<p>Using a boolean array, select the names in Year 2000 (from <code>baby_names</code>) that have larger than 3000 counts. Keep all columns from the original <code>baby_names</code> DataFrame.</p>
<p>Note: Note that compound expressions have to be grouped with parentheses. That is, any time you use <code>p &amp; q</code> to filter the DataFrame, make sure to use <code>df[(df[p]) &amp; (df[q])]</code> or <code>df.loc[(df[p]) &amp; (df[q])]</code>.</p>
<p>You may use either <code>[]</code> or <code>loc</code>. Both will achieve the same result. For more on <code>[]</code> vs. <code>loc</code> see the stack overflow links from the intro portion of this lab.</p>
<!--
BEGIN QUESTION
name: q5
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">baby_names</span><span class="p">[(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3000</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>725638</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Daniel</td>
      <td>4342</td>
    </tr>
    <tr>
      <th>725639</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Anthony</td>
      <td>3839</td>
    </tr>
    <tr>
      <th>725640</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Jose</td>
      <td>3804</td>
    </tr>
    <tr>
      <th>725641</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Andrew</td>
      <td>3600</td>
    </tr>
    <tr>
      <th>725642</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Michael</td>
      <td>3572</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q5&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="query-review">Query Review</h4>
<p>Recall that pandas also has a query command. For example, we can get California baby names with the code below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ca</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;State == &#34;CA&#34;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ca</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>390635</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Mary</td>
      <td>295</td>
    </tr>
    <tr>
      <th>390636</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Helen</td>
      <td>239</td>
    </tr>
    <tr>
      <th>390637</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Dorothy</td>
      <td>220</td>
    </tr>
    <tr>
      <th>390638</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Margaret</td>
      <td>163</td>
    </tr>
    <tr>
      <th>390639</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Frances</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div>
<p>Using the <code>query</code> command, select the names in Year 2000 (from <code>baby_names</code>) that have larger than 3000 counts.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">result_using_query</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Count &gt; 3000 and Year == 2000&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result_using_query</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>725638</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Daniel</td>
      <td>4342</td>
    </tr>
    <tr>
      <th>725639</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Anthony</td>
      <td>3839</td>
    </tr>
    <tr>
      <th>725640</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Jose</td>
      <td>3804</td>
    </tr>
    <tr>
      <th>725641</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Andrew</td>
      <td>3600</td>
    </tr>
    <tr>
      <th>725642</th>
      <td>CA</td>
      <td>M</td>
      <td>2000</td>
      <td>Michael</td>
      <td>3572</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="groupby">Groupby</h2>
<p>Let&rsquo;s now turn to using groupby from lecture 4.</p>
<p><strong>Note:</strong> This <a href="https://docs.google.com/presentation/d/1FC-cs5MTGSkDzI_7R_ZENgwoHQ4aVamxFOpJuWT0fo0/edit#slide=id.g477ed0f02e_0_390" target="_blank" rel="noopener noreffer ">slide</a> provides a visual picture of how <code>groupby.agg</code> works if you&rsquo;d like a reference.</p>
<h3 id="question-6-elections">Question 6: Elections</h3>
<p><strong>Review</strong>: Let&rsquo;s start by reading in the election dataset from the pandas lectures.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">elections</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&#34;data/elections.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1824</td>
      <td>Andrew Jackson</td>
      <td>Democratic-Republican</td>
      <td>151271</td>
      <td>loss</td>
      <td>57.210122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1824</td>
      <td>John Quincy Adams</td>
      <td>Democratic-Republican</td>
      <td>113142</td>
      <td>win</td>
      <td>42.789878</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1828</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>642806</td>
      <td>win</td>
      <td>56.203927</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1828</td>
      <td>John Quincy Adams</td>
      <td>National Republican</td>
      <td>500897</td>
      <td>loss</td>
      <td>43.796073</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1832</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>702735</td>
      <td>win</td>
      <td>54.574789</td>
    </tr>
  </tbody>
</table>
</div>
<p>As we saw, we can groupby a specific column, e.g. &ldquo;Party&rdquo;. It turns out that using some syntax we didn&rsquo;t cover in lecture, we can print out the subframes that result. This isn&rsquo;t something you&rsquo;ll do for any practical purpose. However, it may help you get an understanding of <strong>what groupby is actually doing</strong>.</p>
<p>An example is given below for elections since 1980.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># run this cell</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Name: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span> <span class="c1"># by the way this is an &#34;f string&#34;, a relatively new and great feature of Python</span>
</span></span><span class="line"><span class="cl">    <span class="n">display</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Name: Citizens
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>127</th>
      <td>1980</td>
      <td>Barry Commoner</td>
      <td>Citizens</td>
      <td>233052</td>
      <td>loss</td>
      <td>0.270182</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Constitution
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>160</th>
      <td>2004</td>
      <td>Michael Peroutka</td>
      <td>Constitution</td>
      <td>143630</td>
      <td>loss</td>
      <td>0.117542</td>
    </tr>
    <tr>
      <th>164</th>
      <td>2008</td>
      <td>Chuck Baldwin</td>
      <td>Constitution</td>
      <td>199750</td>
      <td>loss</td>
      <td>0.152398</td>
    </tr>
    <tr>
      <th>172</th>
      <td>2016</td>
      <td>Darrell Castle</td>
      <td>Constitution</td>
      <td>203091</td>
      <td>loss</td>
      <td>0.149640</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Democratic
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>129</th>
      <td>1980</td>
      <td>Jimmy Carter</td>
      <td>Democratic</td>
      <td>35480115</td>
      <td>loss</td>
      <td>41.132848</td>
    </tr>
    <tr>
      <th>134</th>
      <td>1984</td>
      <td>Walter Mondale</td>
      <td>Democratic</td>
      <td>37577352</td>
      <td>loss</td>
      <td>40.729429</td>
    </tr>
    <tr>
      <th>137</th>
      <td>1988</td>
      <td>Michael Dukakis</td>
      <td>Democratic</td>
      <td>41809074</td>
      <td>loss</td>
      <td>45.770691</td>
    </tr>
    <tr>
      <th>140</th>
      <td>1992</td>
      <td>Bill Clinton</td>
      <td>Democratic</td>
      <td>44909806</td>
      <td>win</td>
      <td>43.118485</td>
    </tr>
    <tr>
      <th>144</th>
      <td>1996</td>
      <td>Bill Clinton</td>
      <td>Democratic</td>
      <td>47400125</td>
      <td>win</td>
      <td>49.296938</td>
    </tr>
    <tr>
      <th>151</th>
      <td>2000</td>
      <td>Al Gore</td>
      <td>Democratic</td>
      <td>50999897</td>
      <td>loss</td>
      <td>48.491813</td>
    </tr>
    <tr>
      <th>158</th>
      <td>2004</td>
      <td>John Kerry</td>
      <td>Democratic</td>
      <td>59028444</td>
      <td>loss</td>
      <td>48.306775</td>
    </tr>
    <tr>
      <th>162</th>
      <td>2008</td>
      <td>Barack Obama</td>
      <td>Democratic</td>
      <td>69498516</td>
      <td>win</td>
      <td>53.023510</td>
    </tr>
    <tr>
      <th>168</th>
      <td>2012</td>
      <td>Barack Obama</td>
      <td>Democratic</td>
      <td>65915795</td>
      <td>win</td>
      <td>51.258484</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2016</td>
      <td>Hillary Clinton</td>
      <td>Democratic</td>
      <td>65853514</td>
      <td>loss</td>
      <td>48.521539</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Green
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>149</th>
      <td>1996</td>
      <td>Ralph Nader</td>
      <td>Green</td>
      <td>685297</td>
      <td>loss</td>
      <td>0.712721</td>
    </tr>
    <tr>
      <th>155</th>
      <td>2000</td>
      <td>Ralph Nader</td>
      <td>Green</td>
      <td>2882955</td>
      <td>loss</td>
      <td>2.741176</td>
    </tr>
    <tr>
      <th>156</th>
      <td>2004</td>
      <td>David Cobb</td>
      <td>Green</td>
      <td>119859</td>
      <td>loss</td>
      <td>0.098088</td>
    </tr>
    <tr>
      <th>165</th>
      <td>2008</td>
      <td>Cynthia McKinney</td>
      <td>Green</td>
      <td>161797</td>
      <td>loss</td>
      <td>0.123442</td>
    </tr>
    <tr>
      <th>170</th>
      <td>2012</td>
      <td>Jill Stein</td>
      <td>Green</td>
      <td>469627</td>
      <td>loss</td>
      <td>0.365199</td>
    </tr>
    <tr>
      <th>177</th>
      <td>2016</td>
      <td>Jill Stein</td>
      <td>Green</td>
      <td>1457226</td>
      <td>loss</td>
      <td>1.073699</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2020</td>
      <td>Howard Hawkins</td>
      <td>Green</td>
      <td>405035</td>
      <td>loss</td>
      <td>0.255731</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Independent
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>1980</td>
      <td>John B. Anderson</td>
      <td>Independent</td>
      <td>5719850</td>
      <td>loss</td>
      <td>6.631143</td>
    </tr>
    <tr>
      <th>143</th>
      <td>1992</td>
      <td>Ross Perot</td>
      <td>Independent</td>
      <td>19743821</td>
      <td>loss</td>
      <td>18.956298</td>
    </tr>
    <tr>
      <th>161</th>
      <td>2004</td>
      <td>Ralph Nader</td>
      <td>Independent</td>
      <td>465151</td>
      <td>loss</td>
      <td>0.380663</td>
    </tr>
    <tr>
      <th>167</th>
      <td>2008</td>
      <td>Ralph Nader</td>
      <td>Independent</td>
      <td>739034</td>
      <td>loss</td>
      <td>0.563842</td>
    </tr>
    <tr>
      <th>174</th>
      <td>2016</td>
      <td>Evan McMullin</td>
      <td>Independent</td>
      <td>732273</td>
      <td>loss</td>
      <td>0.539546</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Libertarian
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>128</th>
      <td>1980</td>
      <td>Ed Clark</td>
      <td>Libertarian</td>
      <td>921128</td>
      <td>loss</td>
      <td>1.067883</td>
    </tr>
    <tr>
      <th>132</th>
      <td>1984</td>
      <td>David Bergland</td>
      <td>Libertarian</td>
      <td>228111</td>
      <td>loss</td>
      <td>0.247245</td>
    </tr>
    <tr>
      <th>138</th>
      <td>1988</td>
      <td>Ron Paul</td>
      <td>Libertarian</td>
      <td>431750</td>
      <td>loss</td>
      <td>0.472660</td>
    </tr>
    <tr>
      <th>139</th>
      <td>1992</td>
      <td>Andre Marrou</td>
      <td>Libertarian</td>
      <td>290087</td>
      <td>loss</td>
      <td>0.278516</td>
    </tr>
    <tr>
      <th>146</th>
      <td>1996</td>
      <td>Harry Browne</td>
      <td>Libertarian</td>
      <td>485759</td>
      <td>loss</td>
      <td>0.505198</td>
    </tr>
    <tr>
      <th>153</th>
      <td>2000</td>
      <td>Harry Browne</td>
      <td>Libertarian</td>
      <td>384431</td>
      <td>loss</td>
      <td>0.365525</td>
    </tr>
    <tr>
      <th>159</th>
      <td>2004</td>
      <td>Michael Badnarik</td>
      <td>Libertarian</td>
      <td>397265</td>
      <td>loss</td>
      <td>0.325108</td>
    </tr>
    <tr>
      <th>163</th>
      <td>2008</td>
      <td>Bob Barr</td>
      <td>Libertarian</td>
      <td>523715</td>
      <td>loss</td>
      <td>0.399565</td>
    </tr>
    <tr>
      <th>169</th>
      <td>2012</td>
      <td>Gary Johnson</td>
      <td>Libertarian</td>
      <td>1275971</td>
      <td>loss</td>
      <td>0.992241</td>
    </tr>
    <tr>
      <th>175</th>
      <td>2016</td>
      <td>Gary Johnson</td>
      <td>Libertarian</td>
      <td>4489235</td>
      <td>loss</td>
      <td>3.307714</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2020</td>
      <td>Jo Jorgensen</td>
      <td>Libertarian</td>
      <td>1865724</td>
      <td>loss</td>
      <td>1.177979</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Natural Law
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>148</th>
      <td>1996</td>
      <td>John Hagelin</td>
      <td>Natural Law</td>
      <td>113670</td>
      <td>loss</td>
      <td>0.118219</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: New Alliance
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>136</th>
      <td>1988</td>
      <td>Lenora Fulani</td>
      <td>New Alliance</td>
      <td>217221</td>
      <td>loss</td>
      <td>0.237804</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Populist
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>141</th>
      <td>1992</td>
      <td>Bo Gritz</td>
      <td>Populist</td>
      <td>106152</td>
      <td>loss</td>
      <td>0.101918</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Reform
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>150</th>
      <td>1996</td>
      <td>Ross Perot</td>
      <td>Reform</td>
      <td>8085294</td>
      <td>loss</td>
      <td>8.408844</td>
    </tr>
    <tr>
      <th>154</th>
      <td>2000</td>
      <td>Pat Buchanan</td>
      <td>Reform</td>
      <td>448895</td>
      <td>loss</td>
      <td>0.426819</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Republican
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131</th>
      <td>1980</td>
      <td>Ronald Reagan</td>
      <td>Republican</td>
      <td>43903230</td>
      <td>win</td>
      <td>50.897944</td>
    </tr>
    <tr>
      <th>133</th>
      <td>1984</td>
      <td>Ronald Reagan</td>
      <td>Republican</td>
      <td>54455472</td>
      <td>win</td>
      <td>59.023326</td>
    </tr>
    <tr>
      <th>135</th>
      <td>1988</td>
      <td>George H. W. Bush</td>
      <td>Republican</td>
      <td>48886597</td>
      <td>win</td>
      <td>53.518845</td>
    </tr>
    <tr>
      <th>142</th>
      <td>1992</td>
      <td>George H. W. Bush</td>
      <td>Republican</td>
      <td>39104550</td>
      <td>loss</td>
      <td>37.544784</td>
    </tr>
    <tr>
      <th>145</th>
      <td>1996</td>
      <td>Bob Dole</td>
      <td>Republican</td>
      <td>39197469</td>
      <td>loss</td>
      <td>40.766036</td>
    </tr>
    <tr>
      <th>152</th>
      <td>2000</td>
      <td>George W. Bush</td>
      <td>Republican</td>
      <td>50456002</td>
      <td>win</td>
      <td>47.974666</td>
    </tr>
    <tr>
      <th>157</th>
      <td>2004</td>
      <td>George W. Bush</td>
      <td>Republican</td>
      <td>62040610</td>
      <td>win</td>
      <td>50.771824</td>
    </tr>
    <tr>
      <th>166</th>
      <td>2008</td>
      <td>John McCain</td>
      <td>Republican</td>
      <td>59948323</td>
      <td>loss</td>
      <td>45.737243</td>
    </tr>
    <tr>
      <th>171</th>
      <td>2012</td>
      <td>Mitt Romney</td>
      <td>Republican</td>
      <td>60933504</td>
      <td>loss</td>
      <td>47.384076</td>
    </tr>
    <tr>
      <th>173</th>
      <td>2016</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>62984828</td>
      <td>win</td>
      <td>46.407862</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code>Name: Taxpayers
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>147</th>
      <td>1996</td>
      <td>Howard Phillips</td>
      <td>Taxpayers</td>
      <td>184656</td>
      <td>loss</td>
      <td>0.192045</td>
    </tr>
  </tbody>
</table>
</div>
<p>Recall that once we&rsquo;ve formed groups, we can aggregate each sub-dataframe (a.k.a. group) into a single row using an aggregation function. For example, if we use <code>.agg(np.mean)</code> on the groups above, we get back a single DataFrame where each group has been replaced by a single row. In each column for that aggregate row, the value that appears is the average of all values in that group.</p>
<p>For columns which are non-numeric, e.g. &ldquo;Result&rdquo;, the column is dropped because we cannot compute the mean of the Result.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Equivalently we can use one of the shorthand aggregation functions, e.g. <code>.mean()</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that the index of the dataframe returned by an <code>groupby.agg</code> call is no longer a set of numeric indices from 0 to N-1. Instead, we see that the index for the example above is now the <code>Party</code>. If we want to restore our DataFrame so that <code>Party</code> is a column rather than the index, we can use <code>reset_index</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>IMPORTANT NOTE:</strong> Notice that the code above consists of a series of chained method calls. This sort of code is very very common in Pandas programming and in data science in general. Such chained method calls can sometimes go many layers deep, in which case you might consider adding newlines between lines of code for clarity. For example, we could instead write the code above as:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pandas method chaining</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">                               <span class="o">.</span><span class="n">mean</span><span class="p">()</span>            <span class="c1">## computes the mean values by party</span>
</span></span><span class="line"><span class="cl">                               <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>     <span class="c1">## reset to a numerical index</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that I&rsquo;ve surrounded the entire call by a big set of parentheses so that Python doesn&rsquo;t complain about the indentation. An alternative is to use the \ symbol to indicate to Python that your code continues on to the next line.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pandas method chaining (alternative)</span>
</span></span><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Year &gt;= 1980&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span> \
</span></span><span class="line"><span class="cl">                               <span class="o">.</span><span class="n">mean</span><span class="p">()</span> \
</span></span><span class="line"><span class="cl">                               <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>     
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>IMPORTANT NOTE:</strong> You should NEVER NEVER solve problems like the one above using loops or list comprehensions. This is slow and also misses the entire point of this part of DS100.</p>
<p>Before we continue, we&rsquo;ll print out the election dataset again for your convenience.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1824</td>
      <td>Andrew Jackson</td>
      <td>Democratic-Republican</td>
      <td>151271</td>
      <td>loss</td>
      <td>57.210122</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1824</td>
      <td>John Quincy Adams</td>
      <td>Democratic-Republican</td>
      <td>113142</td>
      <td>win</td>
      <td>42.789878</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1828</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>642806</td>
      <td>win</td>
      <td>56.203927</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1828</td>
      <td>John Quincy Adams</td>
      <td>National Republican</td>
      <td>500897</td>
      <td>loss</td>
      <td>43.796073</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1832</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>702735</td>
      <td>win</td>
      <td>54.574789</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="question-6a">Question 6a</h3>
<p>Using <code>groupby.agg</code> or one of the shorthand methods (<code>groupby.min</code>, <code>groupby.first</code>, etc.), create a Series <code>best_result_percentage_only</code> that returns a Series showing the entire best result for every party, sorted in decreasing order. Your Series should include only parties which have earned at least 10% of the vote in some election. Your result should look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Party
</span></span><span class="line"><span class="cl">Democratic               61.344703
</span></span><span class="line"><span class="cl">Republican               60.907806
</span></span><span class="line"><span class="cl">Democratic-Republican    57.210122
</span></span><span class="line"><span class="cl">National Union           54.951512
</span></span><span class="line"><span class="cl">Whig                     53.051213
</span></span><span class="line"><span class="cl">Liberal Republican       44.071406
</span></span><span class="line"><span class="cl">National Republican      43.796073
</span></span><span class="line"><span class="cl">Northern Democratic      29.522311
</span></span><span class="line"><span class="cl">Progressive              27.457433
</span></span><span class="line"><span class="cl">American                 21.554001
</span></span><span class="line"><span class="cl">Independent              18.956298
</span></span><span class="line"><span class="cl">Southern Democratic      18.138998
</span></span><span class="line"><span class="cl">American Independent     13.571218
</span></span><span class="line"><span class="cl">Constitutional Union     12.639283
</span></span><span class="line"><span class="cl">Free Soil                10.138474
</span></span><span class="line"><span class="cl">Name: %, dtype: float64
</span></span></code></pre></td></tr></table>
</div>
</div><p>A list of named <code>groupby.agg</code> shorthand methods is <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html#aggregation" target="_blank" rel="noopener noreffer ">here</a> (you&rsquo;ll have to scroll down about one page).</p>
<!--
BEGIN QUESTION
name: q6a
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">best_result_percentage_only</span> <span class="o">=</span> <span class="n">elections</span><span class="p">[</span><span class="n">elections</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Party&#39;</span><span class="p">)[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># put your code above this line</span>
</span></span><span class="line"><span class="cl"><span class="n">best_result_percentage_only</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>C:\Users\86135\AppData\Local\Temp\ipykernel_61736\687541662.py:1: FutureWarning: The provided callable &lt;built-in function max&gt; is currently using SeriesGroupBy.max. In a future version of pandas, the provided callable will be used directly. To keep current behavior pass the string &quot;max&quot; instead.
  best_result_percentage_only = elections[elections['%']&gt;=10].groupby('Party')['%'].agg(max).sort_values(ascending=False)





Party
Democratic               61.344703
Republican               60.907806
Democratic-Republican    57.210122
National Union           54.951512
Whig                     53.051213
Liberal Republican       44.071406
National Republican      43.796073
Northern Democratic      29.522311
Progressive              27.457433
American                 21.554001
Independent              18.956298
Southern Democratic      18.138998
American Independent     13.571218
Constitutional Union     12.639283
Free Soil                10.138474
Name: %, dtype: float64
</code></pre>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q6a&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="question-6b">Question 6b</h3>
<p>Repeat Question 6a. However, this time, your result should be a DataFrame showing all available information rather than only the percentage as a series.</p>
<p>This question is trickier than Question 6a. Make sure to check the Lecture 4 slides if you&rsquo;re stuck! It&rsquo;s very easy to make a subtle mistake that shows Woodrow Wilson and Howard Taft both winning the 2020 election.</p>
<p>For example, the first 3 rows of your table should be:</p>
<table>
<thead>
<tr>
<th>Party</th>
<th>Year</th>
<th>Candidate</th>
<th>Popular Vote</th>
<th>Result</th>
<th>%</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Democratic</strong></td>
<td>1964</td>
<td>Lyndon Johnson</td>
<td>43127041</td>
<td>win</td>
<td>61.344703</td>
</tr>
<tr>
<td><strong>Republican</strong></td>
<td>1972</td>
<td>Richard Nixon</td>
<td>47168710</td>
<td>win</td>
<td>60.907806</td>
</tr>
<tr>
<td><strong>Democratic-Republican</strong></td>
<td>1824</td>
<td>Andrew Jackson</td>
<td>151271</td>
<td>loss</td>
<td>57.210122</td>
</tr>
</tbody>
</table>
<p>Note that the index is <code>Party</code>. In other words, don&rsquo;t use <code>reset_index</code>.</p>
<!--
BEGIN QUESTION
name: q6b
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">best_result</span> <span class="o">=</span> <span class="n">elections</span><span class="p">[</span><span class="n">elections</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Party&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @ 52:03 in the video of Lecture 4</span>
</span></span><span class="line"><span class="cl"><span class="c1"># put your code above this line</span>
</span></span><span class="line"><span class="cl"><span class="n">best_result</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
    <tr>
      <th>Party</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Democratic</th>
      <td>1964</td>
      <td>Lyndon Johnson</td>
      <td>43127041</td>
      <td>win</td>
      <td>61.344703</td>
    </tr>
    <tr>
      <th>Republican</th>
      <td>1972</td>
      <td>Richard Nixon</td>
      <td>47168710</td>
      <td>win</td>
      <td>60.907806</td>
    </tr>
    <tr>
      <th>Democratic-Republican</th>
      <td>1824</td>
      <td>Andrew Jackson</td>
      <td>151271</td>
      <td>loss</td>
      <td>57.210122</td>
    </tr>
    <tr>
      <th>National Union</th>
      <td>1864</td>
      <td>Abraham Lincoln</td>
      <td>2211317</td>
      <td>win</td>
      <td>54.951512</td>
    </tr>
    <tr>
      <th>Whig</th>
      <td>1840</td>
      <td>William Henry Harrison</td>
      <td>1275583</td>
      <td>win</td>
      <td>53.051213</td>
    </tr>
    <tr>
      <th>Liberal Republican</th>
      <td>1872</td>
      <td>Horace Greeley</td>
      <td>2834761</td>
      <td>loss</td>
      <td>44.071406</td>
    </tr>
    <tr>
      <th>National Republican</th>
      <td>1828</td>
      <td>John Quincy Adams</td>
      <td>500897</td>
      <td>loss</td>
      <td>43.796073</td>
    </tr>
    <tr>
      <th>Northern Democratic</th>
      <td>1860</td>
      <td>Stephen A. Douglas</td>
      <td>1380202</td>
      <td>loss</td>
      <td>29.522311</td>
    </tr>
    <tr>
      <th>Progressive</th>
      <td>1912</td>
      <td>Theodore Roosevelt</td>
      <td>4122721</td>
      <td>loss</td>
      <td>27.457433</td>
    </tr>
    <tr>
      <th>American</th>
      <td>1856</td>
      <td>Millard Fillmore</td>
      <td>873053</td>
      <td>loss</td>
      <td>21.554001</td>
    </tr>
    <tr>
      <th>Independent</th>
      <td>1992</td>
      <td>Ross Perot</td>
      <td>19743821</td>
      <td>loss</td>
      <td>18.956298</td>
    </tr>
    <tr>
      <th>Southern Democratic</th>
      <td>1860</td>
      <td>John C. Breckinridge</td>
      <td>848019</td>
      <td>loss</td>
      <td>18.138998</td>
    </tr>
    <tr>
      <th>American Independent</th>
      <td>1968</td>
      <td>George Wallace</td>
      <td>9901118</td>
      <td>loss</td>
      <td>13.571218</td>
    </tr>
    <tr>
      <th>Constitutional Union</th>
      <td>1860</td>
      <td>John Bell</td>
      <td>590901</td>
      <td>loss</td>
      <td>12.639283</td>
    </tr>
    <tr>
      <th>Free Soil</th>
      <td>1848</td>
      <td>Martin Van Buren</td>
      <td>291501</td>
      <td>loss</td>
      <td>10.138474</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q6b&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="question-6c">Question 6c</h3>
<p>Our DataFrame contains a number of parties which have never had a successful presidential run. For example, the 2020 elections included candiates from the Libertarian and Green parties, neither of which have elected a president.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">elections</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>177</th>
      <td>2016</td>
      <td>Jill Stein</td>
      <td>Green</td>
      <td>1457226</td>
      <td>loss</td>
      <td>1.073699</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2020</td>
      <td>Jo Jorgensen</td>
      <td>Libertarian</td>
      <td>1865724</td>
      <td>loss</td>
      <td>1.177979</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2020</td>
      <td>Howard Hawkins</td>
      <td>Green</td>
      <td>405035</td>
      <td>loss</td>
      <td>0.255731</td>
    </tr>
  </tbody>
</table>
</div>
<p>Suppose we were conducting an analysis trying to focus our attention on parties that had elected a president.</p>
<p>The most natural approach is to use <code>groupby.filter</code>. This is an incredibly powerful but subtle tool for filtering data.</p>
<p>As a reminder of how filter works, see <a href="https://docs.google.com/presentation/d/1FC-cs5MTGSkDzI_7R_ZENgwoHQ4aVamxFOpJuWT0fo0/edit#slide=id.g5ff184b7f5_0_507" target="_blank" rel="noopener noreffer ">this slide</a>.
The code below accomplishes the task at hand. It does this by creating a function that returns True if and only if a sub-dataframe (a.k.a. group) contains at least one winner. This function in turn uses the <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html" target="_blank" rel="noopener noreffer ">Pandas function &ldquo;any&rdquo;</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">at_least_one_candidate_in_the_frame_has_won</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Returns df with rows only kept for parties that have
</span></span></span><span class="line"><span class="cl"><span class="s2">    won at least one election
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="s2">&#34;Result&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">winners_only</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">elections</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">at_least_one_candidate_in_the_frame_has_won</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">winners_only</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171</th>
      <td>2012</td>
      <td>Mitt Romney</td>
      <td>Republican</td>
      <td>60933504</td>
      <td>loss</td>
      <td>47.384076</td>
    </tr>
    <tr>
      <th>173</th>
      <td>2016</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>62984828</td>
      <td>win</td>
      <td>46.407862</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2016</td>
      <td>Hillary Clinton</td>
      <td>Democratic</td>
      <td>65853514</td>
      <td>loss</td>
      <td>48.521539</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
    </tr>
  </tbody>
</table>
</div>
<p>Alternately we could have used a <code>lambda</code> function instead of explicitly defining a named function using <code>def</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell (alternative)</span>
</span></span><span class="line"><span class="cl"><span class="n">winners_only</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">elections</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Party&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&#34;Result&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;win&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">winners_only</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>171</th>
      <td>2012</td>
      <td>Mitt Romney</td>
      <td>Republican</td>
      <td>60933504</td>
      <td>loss</td>
      <td>47.384076</td>
    </tr>
    <tr>
      <th>173</th>
      <td>2016</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>62984828</td>
      <td>win</td>
      <td>46.407862</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2016</td>
      <td>Hillary Clinton</td>
      <td>Democratic</td>
      <td>65853514</td>
      <td>loss</td>
      <td>48.521539</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
    </tr>
  </tbody>
</table>
</div>
<p>For your exercise, you&rsquo;ll do a less restrictive filtering of the elections data.</p>
<p><strong>Exercise</strong>: Using <code>filter</code>, create a DataFrame <code>major_party_results_since_1988</code> that includes all election results starting in 1988, but only show a row if the Party it belongs to has earned at least 1% of the popular vote in ANY election since 1988.</p>
<p>For example, in 1988, you should not include the <code>New Alliance</code> candidate, since this party has not earned 1% of the vote since 1988. However, you should include the <code>Libertarian</code> candidate from 1988 despite only having 0.47 percent of the vote in 1988, because in 2016 and 2020, the Libertarian candidates Gary Johnson and Jo Jorgensen exceeded 1% of the vote.</p>
<p>For example, the first three rows of the table you generate should look like:</p>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">Year</th>
<th style="text-align:left">Candidate</th>
<th style="text-align:left">Party</th>
<th style="text-align:right">Popular vote</th>
<th style="text-align:left">Result</th>
<th style="text-align:right">%</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">135</td>
<td style="text-align:right">1988</td>
<td style="text-align:left">George H. W. Bush</td>
<td style="text-align:left">Republican</td>
<td style="text-align:right">48886597</td>
<td style="text-align:left">win</td>
<td style="text-align:right">53.5188</td>
</tr>
<tr>
<td style="text-align:right">137</td>
<td style="text-align:right">1988</td>
<td style="text-align:left">Michael Dukakis</td>
<td style="text-align:left">Democratic</td>
<td style="text-align:right">41809074</td>
<td style="text-align:left">loss</td>
<td style="text-align:right">45.7707</td>
</tr>
<tr>
<td style="text-align:right">138</td>
<td style="text-align:right">1988</td>
<td style="text-align:left">Ron Paul</td>
<td style="text-align:left">Libertarian</td>
<td style="text-align:right">431750</td>
<td style="text-align:left">loss</td>
<td style="text-align:right">0.47266</td>
</tr>
</tbody>
</table>
<!--
BEGIN QUESTION
name: q6c
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">major_party_results_since_1988</span> <span class="o">=</span> <span class="n">elections</span><span class="p">[(</span><span class="n">elections</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">1988</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Party&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;%&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">major_party_results_since_1988</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>135</th>
      <td>1988</td>
      <td>George H. W. Bush</td>
      <td>Republican</td>
      <td>48886597</td>
      <td>win</td>
      <td>53.518845</td>
    </tr>
    <tr>
      <th>137</th>
      <td>1988</td>
      <td>Michael Dukakis</td>
      <td>Democratic</td>
      <td>41809074</td>
      <td>loss</td>
      <td>45.770691</td>
    </tr>
    <tr>
      <th>138</th>
      <td>1988</td>
      <td>Ron Paul</td>
      <td>Libertarian</td>
      <td>431750</td>
      <td>loss</td>
      <td>0.472660</td>
    </tr>
    <tr>
      <th>139</th>
      <td>1992</td>
      <td>Andre Marrou</td>
      <td>Libertarian</td>
      <td>290087</td>
      <td>loss</td>
      <td>0.278516</td>
    </tr>
    <tr>
      <th>140</th>
      <td>1992</td>
      <td>Bill Clinton</td>
      <td>Democratic</td>
      <td>44909806</td>
      <td>win</td>
      <td>43.118485</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q6c&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="question-7">Question 7</h3>
<p>Pandas provides special purpose functions for working with specific common data types such as strings and dates. For example, the code below provides the length of every Candidate&rsquo;s name from our elections dataset.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections</span><span class="p">[</span><span class="s2">&#34;Candidate&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>0      14
1      17
2      14
3      17
4      14
       ..
177    10
178    12
179    12
180    12
181    14
Name: Candidate, Length: 182, dtype: int64
</code></pre>
<p><strong>Exercise</strong>: Using <code>.str.split</code>. Create a new DataFrame called <code>elections_with_first_name</code> with a new column <code>First Name</code> that is equal to the Candidate&rsquo;s first name.</p>
<p>See the Pandas <code>str</code> <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.split.html" target="_blank" rel="noopener noreffer ">documentation</a> for documentation on using <code>str.split</code>.</p>
<p>Hint: Use <code>[0]</code> somewhere in your code.</p>
<!--
BEGIN QUESTION
name: q7
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elections_with_first_name</span> <span class="o">=</span> <span class="n">elections</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># your code here</span>
</span></span><span class="line"><span class="cl"><span class="n">elections_with_first_name</span><span class="p">[</span><span class="s1">&#39;First Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elections_with_first_name</span><span class="p">[</span><span class="s1">&#39;Candidate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># end your code</span>
</span></span><span class="line"><span class="cl"><span class="n">elections_with_first_name</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
      <th>First Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1824</td>
      <td>Andrew Jackson</td>
      <td>Democratic-Republican</td>
      <td>151271</td>
      <td>loss</td>
      <td>57.210122</td>
      <td>Andrew</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1824</td>
      <td>John Quincy Adams</td>
      <td>Democratic-Republican</td>
      <td>113142</td>
      <td>win</td>
      <td>42.789878</td>
      <td>John</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1828</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>642806</td>
      <td>win</td>
      <td>56.203927</td>
      <td>Andrew</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1828</td>
      <td>John Quincy Adams</td>
      <td>National Republican</td>
      <td>500897</td>
      <td>loss</td>
      <td>43.796073</td>
      <td>John</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1832</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>702735</td>
      <td>win</td>
      <td>54.574789</td>
      <td>Andrew</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>177</th>
      <td>2016</td>
      <td>Jill Stein</td>
      <td>Green</td>
      <td>1457226</td>
      <td>loss</td>
      <td>1.073699</td>
      <td>Jill</td>
    </tr>
    <tr>
      <th>178</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
      <td>Joseph</td>
    </tr>
    <tr>
      <th>179</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
      <td>Donald</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2020</td>
      <td>Jo Jorgensen</td>
      <td>Libertarian</td>
      <td>1865724</td>
      <td>loss</td>
      <td>1.177979</td>
      <td>Jo</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2020</td>
      <td>Howard Hawkins</td>
      <td>Green</td>
      <td>405035</td>
      <td>loss</td>
      <td>0.255731</td>
      <td>Howard</td>
    </tr>
  </tbody>
</table>
<p>182 rows × 7 columns</p>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q7&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><pre style='display: inline;'>q7</pre></strong> passed! 🙌</p>
<h3 id="question-8">Question 8</h3>
<p>The code below creates a table with the frequency of all names from 2020.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">baby_names_2020</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Year == 2020&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&#34;Name&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="o">.</span><span class="n">sum</span><span class="p">()[[</span><span class="s2">&#34;Count&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">              <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">baby_names_2020</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aaden</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aadhira</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Aadhvik</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Aadhya</td>
      <td>186</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aadi</td>
      <td>14</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8697</th>
      <td>Zymere</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8698</th>
      <td>Zymir</td>
      <td>74</td>
    </tr>
    <tr>
      <th>8699</th>
      <td>Zyon</td>
      <td>130</td>
    </tr>
    <tr>
      <th>8700</th>
      <td>Zyra</td>
      <td>33</td>
    </tr>
    <tr>
      <th>8701</th>
      <td>Zyrah</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>8702 rows × 2 columns</p>
</div>
<p><strong>Exercise</strong>: Using the <code>pd.merge</code> function described in lecture, combine the <code>baby_names_2020</code> table with the <code>elections_with_first_name</code> table you created earlier to form <code>presidential_candidates_and_name_popularity</code>.</p>
<!--
BEGIN QUESTION
name: q8
-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">presidential_candidates_and_name_popularity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">elections_with_first_name</span><span class="p">,</span><span class="n">baby_names_2020</span><span class="p">,</span>  <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;First Name&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">presidential_candidates_and_name_popularity</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Candidate</th>
      <th>Party</th>
      <th>Popular vote</th>
      <th>Result</th>
      <th>%</th>
      <th>First Name</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1824</td>
      <td>Andrew Jackson</td>
      <td>Democratic-Republican</td>
      <td>151271</td>
      <td>loss</td>
      <td>57.210122</td>
      <td>Andrew</td>
      <td>Andrew</td>
      <td>5991</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1824</td>
      <td>John Quincy Adams</td>
      <td>Democratic-Republican</td>
      <td>113142</td>
      <td>win</td>
      <td>42.789878</td>
      <td>John</td>
      <td>John</td>
      <td>8180</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1828</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>642806</td>
      <td>win</td>
      <td>56.203927</td>
      <td>Andrew</td>
      <td>Andrew</td>
      <td>5991</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1828</td>
      <td>John Quincy Adams</td>
      <td>National Republican</td>
      <td>500897</td>
      <td>loss</td>
      <td>43.796073</td>
      <td>John</td>
      <td>John</td>
      <td>8180</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1832</td>
      <td>Andrew Jackson</td>
      <td>Democratic</td>
      <td>702735</td>
      <td>win</td>
      <td>54.574789</td>
      <td>Andrew</td>
      <td>Andrew</td>
      <td>5991</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>2016</td>
      <td>Hillary Clinton</td>
      <td>Democratic</td>
      <td>65853514</td>
      <td>loss</td>
      <td>48.521539</td>
      <td>Hillary</td>
      <td>Hillary</td>
      <td>20</td>
    </tr>
    <tr>
      <th>149</th>
      <td>2020</td>
      <td>Joseph Biden</td>
      <td>Democratic</td>
      <td>81268924</td>
      <td>win</td>
      <td>51.311515</td>
      <td>Joseph</td>
      <td>Joseph</td>
      <td>8349</td>
    </tr>
    <tr>
      <th>150</th>
      <td>2020</td>
      <td>Donald Trump</td>
      <td>Republican</td>
      <td>74216154</td>
      <td>loss</td>
      <td>46.858542</td>
      <td>Donald</td>
      <td>Donald</td>
      <td>407</td>
    </tr>
    <tr>
      <th>151</th>
      <td>2020</td>
      <td>Jo Jorgensen</td>
      <td>Libertarian</td>
      <td>1865724</td>
      <td>loss</td>
      <td>1.177979</td>
      <td>Jo</td>
      <td>Jo</td>
      <td>6</td>
    </tr>
    <tr>
      <th>152</th>
      <td>2020</td>
      <td>Howard Hawkins</td>
      <td>Green</td>
      <td>405035</td>
      <td>loss</td>
      <td>0.255731</td>
      <td>Howard</td>
      <td>Howard</td>
      <td>131</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 9 columns</p>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&#34;q8&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="bonus-exercises">Bonus Exercises</h2>
<p>The following exercises are optional and use the <code>ca_baby_names</code> dataset defined below.</p>
<p>perhaps next time! &#x1f60e;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">ca_baby_names</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;State == &#34;CA&#34;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ca_baby_names</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Sex</th>
      <th>Year</th>
      <th>Name</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>390635</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Mary</td>
      <td>295</td>
    </tr>
    <tr>
      <th>390636</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Helen</td>
      <td>239</td>
    </tr>
    <tr>
      <th>390637</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Dorothy</td>
      <td>220</td>
    </tr>
    <tr>
      <th>390638</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Margaret</td>
      <td>163</td>
    </tr>
    <tr>
      <th>390639</th>
      <td>CA</td>
      <td>F</td>
      <td>1910</td>
      <td>Frances</td>
      <td>134</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>784809</th>
      <td>CA</td>
      <td>M</td>
      <td>2020</td>
      <td>Ziaan</td>
      <td>5</td>
    </tr>
    <tr>
      <th>784810</th>
      <td>CA</td>
      <td>M</td>
      <td>2020</td>
      <td>Ziad</td>
      <td>5</td>
    </tr>
    <tr>
      <th>784811</th>
      <td>CA</td>
      <td>M</td>
      <td>2020</td>
      <td>Ziaire</td>
      <td>5</td>
    </tr>
    <tr>
      <th>784812</th>
      <td>CA</td>
      <td>M</td>
      <td>2020</td>
      <td>Zidan</td>
      <td>5</td>
    </tr>
    <tr>
      <th>784813</th>
      <td>CA</td>
      <td>M</td>
      <td>2020</td>
      <td>Zymir</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>394179 rows × 5 columns</p>
</div>
<h4 id="sorted-female-name-counts">Sorted Female Name Counts</h4>
<p>Create a Series <code>female_name_since_2000_count</code> which gives the total number of occurrences of each name for female babies born in California from the year 2000 or later. The index should be the name, and the value should be the total number of births. Your Series should be ordered in decreasing order of count. For example, your first row should have index &ldquo;Emily&rdquo; and value 52334, because 52334 Emilys have been born since the year 2000 in California.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">female_name_since_2000_count</span> <span class="o">=</span> 
</span></span><span class="line"><span class="cl"><span class="n">female_name_since_2000_count</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="counts-for-all-names">Counts for All Names</h4>
<p>Using <code>groupby</code>, create a Series <code>count_for_names_2020</code> listing all baby names from 2020 in California, in decreasing order of popularity. The result should not be broken down by sex! If a name is used by both male and female babies, the number you provide should be the total.</p>
<p><strong>Note:</strong> <em>In this question we are now computing the number of registered babies with a given name.</em></p>
<p>For example, <code>count_for_names_2020[&quot;Noah&quot;]</code> should be the number 2631 because in 2018 there were 2631 Noahs born (23 female and 2608 male).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">count_for_names_2020</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="extra-explore-the-data-set">Extra: Explore the Data Set</h3>
<p>The popularity of some baby names may be influenced by cultural phenomena, such as a political figure coming to power.  Below, we plot the popularity of name Hillary for female babies in Calfiornia over time. What do you notice about this plot? What real-world events in the U.S. occurred when there was a steep drop in babies named Hillary?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">hillary_baby_name</span> <span class="o">=</span> <span class="n">baby_names</span><span class="p">[(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Hillary&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">baby_names</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hillary_baby_name</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">hillary_baby_name</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;Hillary Popularity Over Time&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The code above is hard coded to generate a dataframe representing the popularity of the female name Hillary in the state of California. While this approach works, it&rsquo;s inelegant.</p>
<p>Here we&rsquo;ll use a more elegant approach that builds a dataframe such that:</p>
<ol>
<li>It contains ALL names.</li>
<li>The counts are summed across all 50 states, not just California.</li>
</ol>
<p>To do this, we use <code>groupby</code>, though here we&rsquo;re grouping on <strong>two columns</strong> (&ldquo;Name&rdquo; and &ldquo;Year&rdquo;) instead of just one. After grouping, we use the <code>sum</code> aggregation function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">counts_aggregated_by_name_and_year</span> <span class="o">=</span> <span class="n">baby_names</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&#34;Name&#34;</span><span class="p">,</span> <span class="s2">&#34;Year&#34;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">counts_aggregated_by_name_and_year</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that the resulting DataFrame is multi-indexed, i.e. it has two indices. The outer index is the Name, and the inner index is the Year.</p>
<p>In order to visualize this data, we&rsquo;ll use <code>reset_index</code> in order to set the index back to an integer and transform the Name and Year back into columnar data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">counts_aggregated_by_name_and_year</span> <span class="o">=</span> <span class="n">counts_aggregated_by_name_and_year</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">counts_aggregated_by_name_and_year</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Similar to before, we can plot the popularity of a given name by selecting the name we want to visualize. The code below is very similar to the plotting code above, except that we use query to get the name of interest instead of using a boolean array.</p>
<p><strong>Note</strong>: Here we use a special syntax <code>@name_of_interest</code> to tell the query command to use the python variable <code>name_of_interest</code>.</p>
<p>Try out some other names and see what trends you observe. Note that since this is the American social security database, international names are not well represented.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># just run this cell</span>
</span></span><span class="line"><span class="cl"><span class="n">name_of_interest</span> <span class="o">=</span> <span class="s1">&#39;Hillary&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">chosen_baby_name</span> <span class="o">=</span> <span class="n">counts_aggregated_by_name_and_year</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&#34;Name == @name_of_interest&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chosen_baby_name</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">chosen_baby_name</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Popularity Of </span><span class="si">{</span><span class="n">name_of_interest</span><span class="si">}</span><span class="s2"> Over Time&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>To double-check your work, the cell below will rerun all of the autograder tests.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">check_all</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="submission">Submission</h2>
<p>Make sure you have run all cells in your notebook in order before running the cell below, so that all images/graphs appear in the output. The cell below will generate a zip file for you to submit. <strong>Please save before exporting!</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Save your notebook first, then run this cell to export your submission.</span>
</span></span><span class="line"><span class="cl"><span class="n">grader</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">pdf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-07-15</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/datalab2/" data-title="DATA100-lab2" data-hashtags="Pandas"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/datalab2/" data-hashtag="Pandas"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.org/datalab2/" data-title="DATA100-lab2"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.org/datalab2/" data-title="DATA100-lab2"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.org/datalab2/" data-title="DATA100-lab2"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/pandas/">Pandas</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/datal7/" class="prev" rel="prev" title="DATA100-L7: Visualization Ⅰ"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>DATA100-L7: Visualization Ⅰ</a>
            <a href="/datal8/" class="next" rel="next" title="DATA100-L8: Visualizations Ⅱ">DATA100-L8: Visualizations Ⅱ<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.123.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">HHZZ</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
